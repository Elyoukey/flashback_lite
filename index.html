<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">

  <style>
    body{
      height:100%;
    }
    .splash{
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      text-align: center;
      background: #f1f1f1;
      z-index: 10;
      opacity: 1;
      visibility: visible;
      transition: opacity 500ms linear;
    }

    .splash.fadded{
      opacity: 0;
      visibility: hidden;
      transition: visibility 0s 500ms, opacity 500ms linear;
    }

    #container{
      height: 100%;
      width: 100%;
      position: absolute;
      padding: 0;
      box-sizing: border-box;
    }

    .card-menu{
      background: rgba( 0,0,0,0.6);
      line-height: 15px;
      width: 100%;

      box-sizing: border-box;

      white-space: nowrap;
      text-align: center;
      z-index: 5;

      overflow-x: auto;
      overflow-y: hidden;
    }

    .card-menu .menu-item{
      background: #3e2564;
      border: 2px solid #3e2564;
      border-radius: 7px;
      margin: 7px 10px;
      display: inline-block;
      overflow: hidden;
      text-align: center;
      width: 60px;
      height: 40px;

      pointer-events: none;
    }

    .card-menu .menu-item.active.selected {
      border: 2px solid #ffdb55;
    }
    .card-menu .menu-item.active{
      border: 2px solid #3e2564;
      pointer-events: all;
    }

    .card-menu .menu-item img{
      height: 40px;
      opacity: 0;
    }

    .card-menu .menu-item.active img{
      opacity: 1
    }

    #canvas{

      text-align: center;
      box-sizing: border-box;
      border-radius: 20px;
      margin: 20px auto;

    }
    #canvas .puzzlepiece{
      height: 100%;
      width: auto;
      margin: auto;
      border: 10px solid #b655a0;
      border-radius: 15px;
      display: inline-block;

      position: relative;
      top:0;
      left:0;

    }

    @media (max-aspect-ratio: 4/3) {
      #canvas{
        width: 85%;
        height: auto;

      }
      #canvas .puzzlepiece .image{
        top:0;
        left:0;
        width: 100%;
        display: inline-block;
      }
    }
    @media (min-aspect-ratio: 4/3) {
      #canvas{
        height: 80%;
        width: auto;
        margin-top: 7px;
      }
      #canvas .puzzlepiece .image{
        height: 100%;
        width: auto;
      }
      .card-menu .menu-item{
        margin: 2px 20px;
      }
    }

    #canvas .puzzlepiece{
      display: none;
    }
    #canvas .puzzlepiece:target,
    #canvas .puzzlepiece.first-selected
    {
      opacity: 1;
      z-index: 1;
      display: inline-block;
    }

    #canvas .puzzlepiece .hiddenbutton{
      cursor: default;
      -background: red;
      opacity: 0.3;
    }


    #canvas #question-list{
      width:100%;
      height: 100%;
      background: #b855a0;
      text-align: center;
    }

    #canvas #question-list .question{
      border: 5px solid grey;
      border-radius: 20px;
      width: 25%;
      height: 20%;
      overflow: hidden;
      margin-top: 5%;
    }

    #canvas #question-list #question1{ margin-left: 5%; }
    #canvas #question-list #question2{ margin-left: 40%; }
    #canvas #question-list #question3{ margin-left: 70%; }

    #canvas #question-list .question .card{
      opacity: 0;
      background: white;
      width: 200px;
      height: 150px;
    }
    #canvas #question-list .question.active .card{
      opacity: 1;
      transition: opacity 1s ease-out;
    }

    /* Style for tuto */
    #hint-doghead{
      position: fixed;
      width: 100%;
      height: 100%;
      top:0;
      left:0;
      border: 1px solid rgba(0,0,0,.5);
      z-index:11;
box-sizing: border-box;
    }

    #hint-doghead .magnifier{
      position: relative;
      top:-100px;
      left:-100px;
      width: 200%;
    }



  </style>
</head>

<body>
<!--
<div id="splash-1" class="splash">
  <p>
    <i>Welcome Flavor text 1 </i>
  </p>
  <button onclick="$('splash-1').classList.add('fadded');">
    Commencer
  </button>
</div>
<div id="splash-2" class="splash fadded">
  <p>
    <i>Well done flavor text2 </i>
  </p>
</div>
-->
<div id="container">

  <div class="card-menu" id="left-menu">
    <a class="menu-item active selected" id="menu1" href="#card1">
      <img src="img/game/p-01color.jpg" alt="First card" >
    </a>
    <a class="menu-item" id="menu-card2" href="#card2" >
      <img src="img/game/p-02color.jpg" alt="Secund card">
    </a>
    <a class="menu-item" id="menu3" href="#card3">
      <img src="img/game/p-03color.jpg" alt="Third card">
    </a>
    <a class="menu-item"  id="menu4" href="#card4">
      <img src="img/game/p-04color.jpg" alt="Fourth card">
    </a>
    <a class="menu-item" id="menu5" href="#card5">
      <img src="img/game/p-05color.jpg" alt="Fifth card">
    </a>
    <a class="menu-item" id="menu6" href="#card6">
      <img src="img/game/p-06color.jpg" alt="Sixth card">
    </a>
    <a class="menu-item" id="menu7" href="#card7">
      <img src="img/game/p-07color.jpg" alt="Seventh card">
    </a>
    <a class="menu-item" id="menu8" href="#question-list">
      ? ? ?
    </a>
  </div>

  <div id="canvas">

    <div class="puzzlepiece first-selected" id="card1" data-scale="0" >
        <img src="img/game/p-01color.jpg" class="image" />
        <a id="card1-doghead" class="hiddenbutton" href="#card2" style="position: absolute; left:28%; top:51%; width:15%;height:18%;"> </a>
        <a id="card1-retro" class="hiddenbutton" href="#card3" style=" position: absolute; left: 65%; top: 12%; width: 31%; height:24%;  transform: rotate(-30deg)"> </a>
    </div>
    <div class="puzzlepiece " id="card2" data-scale="0" >
      <img src="img/game/p-02color.jpg" class="image" />
      <a id="card2-zombie" class="hiddenbutton" href="#card4" style="position: absolute; left: 21%; top:50%; width:5%;height:11%; "> </a>
      <a id="card2-question1" class="hiddenbutton" href="#question-list" style="position: absolute; left: 78%; top:80%; width: 17%;height:15%; "> </a>
    </div>
    <div class="puzzlepiece " id="card3" data-scale="0" >
      <img src="img/game/p-03color.jpg"  class="image" />
      <a id="card3-visiere" class="hiddenbutton" href="#card5" style="position: absolute; left: 44%; top: 58%; width: 12%; height:5%; "> </a>
    </div>
    <div class="puzzlepiece " id="card4" data-scale="0" >
      <img src="img/game/p-04color.jpg" class="image" />
    </div>
    <div class="puzzlepiece " id="card5" data-scale="0" >
      <img src="img/game/p-05color.jpg" class="image" />
      <a id="card5-head" class="hiddenbutton" href="#card6" style="position: absolute; left: 32%; top: 50%; width:5%; height:7%; "> </a>
    </div>
    <div class="puzzlepiece " id="card6" data-scale="0" >
      <img src="img/game/p-06color.jpg" class="image" />
      <a id="card6-clown" class="hiddenbutton" href="#card7" style="position: absolute; left: 45%; top: 87%; width: 16%; height: 10%; "> </a>
    </div>
    <div class="puzzlepiece " id="card7" data-scale="0" >
      <img src="img/game/p-07color.jpg" class="image" />
      <a id="card7-doghead" class="hiddenbutton" href="#question-list" style="position: absolute; left:0; top:0; width:20%;height:20%; "> </a>
    </div>
    <div id="question-list" class="puzzlepiece" data-targeter="menu8">
      <div class="question" id="question1">
        <div class="card">Question 1 ?</div>
      </div>
      <div class="question" id="question2">
        <div class="card">Question 2 ?</div>
      </div>
      <div class="question" id="question3">
        <div class="card">Question 3 ?</div>
      </div>
      <button onclick="$('splash-2').classList.remove('fadded');">
        Fin du jeu!
      </button>
    </div>
  </div>

</div>
<div id="hint-doghead" class="hint">

</div>

  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>

  <script>
      /* ------------------------------------------------------Utilities */
      function $(id){ return document.getElementById(id);}
      function $_(q){ return document.querySelector(q);}
      function $_s(q){ return document.querySelectorAll(q);}

      /* --------------------------------------------------- Variables */
      var lastPosX = 0; // for image dragging
      var lastPosY = 0; // for image dragging
      var isDragging = false; // for image dragging
      var isPinching = false; // for image dragging

      /* ----------------------------------------------------- Dom elements */
      var $puzzlepieces;
      var $hiddenbuttons;
      var $menupieces;
      var $canvas;
      var $tutohintDoghead;

      /* ----------------------------------------------------- DOM load */
      document.addEventListener("DOMContentLoaded", function() {

        // initiate dom elements
        $menupieces = $_s('#left-menu .menu-item');
        $puzzlepieces = $_s('#canvas .puzzlepiece');
        $firstpuzzlepiece = $_('#canvas .puzzlepiece.first-selected');
        $hiddenbuttons = $_s('#canvas .puzzlepiece .hiddenbutton');
        $canvas = $('canvas');
        $tutohintDoghead = $('hint-doghead');

        // redirect to card 1 if current #card is not active
        let hash = window.location.hash;
        if(hash){
          if ( ! $_(hash).classList.contains('active')){
            window.location = window.location.href.replace(window.location.hash,"");
          }
        }

        // menu selection
        for( let i=0 ; i< $menupieces.length; i++){
          $menupieces[i].addEventListener('click',function(e){
            for( let i=0 ; i< $menupieces.length; i++){
              $menupieces[i].classList.remove('selected');
            }
            this.classList.add('selected');
          });
        }

        // menu activation
        for( let i=0 ; i< $hiddenbuttons.length; i++){
          $hiddenbuttons[i].addEventListener('click',function(e){
            $('hint-doghead').classList.remove('hint');// desactivate hint after click
            $firstpuzzlepiece.classList.remove('first-selected'); //remove first selected
            for(let i=0; i< $menupieces.length;i++){
              if(this.getAttribute('href') == $menupieces[i].getAttribute('href')){
                $menupieces[i].classList.add('active');
                for( let i=0 ; i< $menupieces.length; i++){
                  $menupieces[i].classList.remove('selected');
                }
                $menupieces[i].classList.add('selected');
              }
            }
          });
        }

        // tuto positionning
        let linkpos = $('card1-doghead').getBoundingClientRect();
        console.log(linkpos);
        $tutohintDoghead.style.borderTopWidth = linkpos.top+'px';
        $tutohintDoghead.style.borderLeftWidth = linkpos.left+'px';        ;
        $tutohintDoghead.style.borderBottomWidth = (window.innerHeight - linkpos.top - linkpos.height) +'px';
        $tutohintDoghead.style.borderRightWidth = (window.innerWidth - linkpos.left - linkpos.width) +'px';

        $tutohintDoghead.style.width = window.innerWidth+'px';
        $tutohintDoghead.style.height = window.innerHeight+'px';

      });



  </script>
</body>

</html>
